<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Justified Gallery (Local Folder)</title>

  <!-- justifiedGallery CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.8.1/css/justifiedGallery.min.css" />

  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial; margin: 20px; background-color:#000; }
    h1 { font-size: 1.4rem; margin-bottom: 0.2rem; }
    #gallery { margin-top: 16px; }
    .note { margin-top:8px; font-size:0.9rem; color:#444 }
  </style>
</head>
<body>
  <div id="gallery"></div>

  <!-- jQuery (required by justifiedGallery) -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.8.1/js/jquery.justifiedGallery.min.js"></script>

  <script>
  (function(){
    const gallery = document.getElementById('gallery');
    const $gallery = $(gallery);

    // List of extensions to consider as images
    const imageExtensions = ['jpg','jpeg','png','gif','webp','bmp','avif'];

    // Fetch directory listing (requires running on a web server)
    fetch('./images/')
      .then(response => response.text())
      .then(html => {
        const parser = new DOMParser();
        const doc = parser.parseFromString(html, 'text/html');
        const links = Array.from(doc.querySelectorAll('a'));
        const imageLinks = links.filter(a => {
          const href = a.getAttribute('href');
          return imageExtensions.some(ext => href.toLowerCase().endsWith('.' + ext));
        }).map(a => a.getAttribute('href'));

        if (imageLinks.length === 0) {
          gallery.innerHTML = '<p>No images found in this directory.</p>';
          return;
        }

        // Create image elements
        imageLinks.forEach((src, idx) => {
          const a = document.createElement('a');
          a.href = "#";
          const img = document.createElement('img');
          img.src = "./images/"+src;
//          img.alt = src;
          a.appendChild(img);
          gallery.appendChild(a);
        });

        imagesLoaded(gallery, () => {
          $gallery.justifiedGallery({
            rowHeight: 450,
            margins: 6,
            lastRow: 'justify',
            rel: 'gallery'
          });
        });
      })
      .catch(err => {
        gallery.innerHTML = '<p style="color:red">Failed to load directory listing. Please serve this folder via a local web server.</p>';
        console.error(err);
      });
  })();
  </script>
</body>
</html>

